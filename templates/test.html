{% extends "base.html" %}
{% block body %}
<div>
    <form id="emit" method="POST" action='#'>
        <input type="text" name="emit_data" id="emit_data" placeholder="Message">
        <input type="submit" value="Echo">
    </form>
</div>
<h2>Receive:</h2>
<div id="log"></div>
{% endblock %}
{% block scripts %}
<script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"
    integrity="sha256-yr4fRk/GU1ehYJPAs8P4JlTgu0Hdsp4ZKrx8bDEDC3I=" crossorigin="anonymous"></script>
<script type="text/javascript" charset="utf-8">
    var socket = io();
    socket.on('connect', function () {
        socket.emit('my event', { data: 'I\'m connected!' });
    });

    $('form#emit').submit(function (event) {
        socket.emit('my_event', { data: $('#emit_data').val() });
        return false;
    });
    socket.on('my_response', function (msg, cb) {
        $('#log').append('<br>' + $('<div/>').text('Received: ' + msg.data).html());
        if (cb)
            cb();
    });

</script>
{% endblock %}